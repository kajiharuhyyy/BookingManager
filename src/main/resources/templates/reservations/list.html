<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Reservations</title>
</head>
<body>
<h1>予約一覧</h1>

<form th:action="@{/reservations}" method="get">
  <label>会議室：</label>
  <select name="roomId">
    <option value="">-- 全て --</option>
    <option th:each="r : ${rooms}"
            th:value="${r.id}"
            th:text="${r.name}"
            th:selected="${selectedRoomId != null and r.id == selectedRoomId}">
    </option>
  </select>

  <label>日付：</label>
  <input type="date" name="bookDate" th:value="${selectedBookDate}" />

  <button type="submit">検索</button>
  <a th:href="@{/reservations/new}">新規予約</a>
</form>

<hr/>

<table border="1">
  <thead>
    <tr>
      <th>会議室</th>
      <th>日付</th>
      <th>開始</th>
      <th>終了</th>
      <th>予約名</th>
      <th>担当者</th>
      <th>ステータス</th>
      <th>操作</th>
    </tr>
  </thead>

  <tbody>
    <tr th:each="r : ${reservations}">
      <td th:text="${r.room.name}"></td>
      <td th:text="${r.bookDate}"></td>
      <td th:text="${r.startTime}"></td>
      <td th:text="${r.endTime}"></td>
      <td th:text="${r.title}"></td>
      <td th:text="${r.personName}"></td>
      <td th:text="${r.status}"></td>

      <td>
        <!-- 編集リンク -->
        <a th:href="@{|/reservations/${r.id}/edit|}">編集</a>

        <!-- キャンセル（BOOKEDのときだけ表示） -->
        <form th:if="${r.status.name() == 'BOOKED'}"
              th:action="@{|/reservations/${r.id}/cancel|}"
              method="post"
              style="display:inline;">
          <button type="submit" onclick="return confirm('この予約をキャンセルしますか？')">
            キャンセル
          </button>
        </form>
      </td>
    </tr>
  </tbody>
</table>

</body>
</html>